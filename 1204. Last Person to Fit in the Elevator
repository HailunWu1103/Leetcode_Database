SELECT person_name
FROM (
    SELECT *, SUM(weight)OVER(ORDER BY turn ASC ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) as sum_w
    FROM Queue
) sub
WHERE sum_w<=1000
ORDER BY sum_w DESC
LIMIT 1
