SELECT Id, Month, SUM(Salary)OVER(PARTITION BY Id ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING) AS Salary
FROM (
    SELECT *, COUNT(Month)OVER(PARTITION BY Id) AS cnt, RANK()OVER(PARTITION BY Id ORDER BY Month DESC)-1 AS r
    FROM Employee
) sub
WHERE r>0 AND r<=3
ORDER BY Id ASC, Month DESC
